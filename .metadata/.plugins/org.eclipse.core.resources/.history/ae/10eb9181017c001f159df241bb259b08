package Procesos;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.PrintWriter;

public class guardarSVCHOST {
	
	public static void main(String[] args) throws FileNotFoundException {
		FileOutputStream fos = new FileOutputStream(args[0]);
		PrintWriter pw = new PrintWriter(fos);

		Runtime r = Runtime.getRuntime();
		String comando = "tasklist /svc /fi \"imagename eq svchost.exe\"";	
		String linea;
		Process p;
		
		try {
			p = r.exec(comando);
			InputStream salidaComando = p.getInputStream();
			BufferedReader buffer = new BufferedReader(new InputStreamReader(salidaComando));
			linea = buffer.readLine();
			while(linea!= null) {
				System.out.println("INSERTO EN " +args[0] +" > " + linea);
				pw.println(linea);
			}
			buffer.close();
		}
		catch(Exception e){
			System.out.println("Error en " + comando);
			e.printStackTrace();
		}
		int exitVal;
		try {
			exitVal = p.waitFor();
			System.out.println("Valor de Salida " + exitVal);
		} catch(InterruptedException e) {
			e.printStackTrace();
			}
	}

}
